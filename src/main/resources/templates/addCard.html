<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	
	<title>Crazy Database</title>
	
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/ui-darkness/jquery-ui.css"/>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
	<link rel="stylesheet" href="css/main.css"/>
	
	<!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top">
	<div class="container">
		<div class="navbar-header">
			<a class="navbar-brand" href="/" style="background-color: whitesmoke; color: black">Crazy Database</a>
		</div>
	</div>
</nav>
<div class="container">
	<div class="page-header">
		<h1>Add a <span style="color: #ff0000">fake</span> card this CRAZY DATABASE</h1>
		<h2>See lists of <span style="color: red">fake</span> card numbers that will pass the validator<a href="https://www.freeformatter.com/credit-card-number-generator-validator.html"> CLICK</a> and add</h2>
	</div>
	
	
	<h1>Fill this form</h1>
	<form onsubmit="return mySubmitFunction(event)"name="form" style="text-align: center" th:action="@{/card}" th:object="${card}" method="post">
		
		<p>Card Number: <input required = "required" type="text" name="cardNumber" th:maxlength="20" onblur="visaValidation(document.form.cardNumber)" th:field="*{cardNumber}" /></p>
		<p>Name on Card: <input required = "required" type="text" th:field="*{cardOwnerName}" /></p>
		<p>CVV: <input required = "required" type="text" th:field="*{cvv}" th:min="3" th:maxlength="3" /></p>
		<p>Card Type: <select  th:field="*{cardType}">
			<option th:value="'MASTERCARD'" th:text="MASTERCARD"></option>
			<option th:value="'VISA'" th:text="VISA"></option>
			<option th:value="'VERVE'" th:text="VERVE"></option>
			<option th:value="'AMERICAN-EXPRESS'" th:text="AMERICAN-EXPRESS"></option>
		</select>
		</p>
		<p>Bank name: <input required = "required" type="text" th:field="*{bankName}" /></p>
		<p><input type="submit" value="Submit" /> <input type="reset" value="Reset"/></p>
	</form>
	
</div>


<script src="http://code.jquery.com/jquery-1.12.4.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script th:inline="javascript">
    let validationValue;
    function visaValidation(cardNumber) {
        
        let visaValidation = /^(?:4[0-9]{12}(?:[0-9]{3})?)$/;
        if (cardNumber.value.match(visaValidation)) {
            // alert("Valid Visa credit card number!");
			validationValue = true;
            return true;
            
        } else {
            alert("Not a valid Visa credit card number!");
            validationValue = false;
            return false;
        }
        
    }
    
    
    function submitError() {
        if (validationValue === false){
            alert("Check your credit card number. Make sure its valid then try again");
		}

    }
    function mySubmitFunction(e) {
        if (validationValue === false){
            e.preventDefault();
            submitError();
            return false;
		}else {
            return true;
		}
    
    }
</script>
<script type="text/javascript" th:src="@{js/main.js}"></script>
</body>
</html>